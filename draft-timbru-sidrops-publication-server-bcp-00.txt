



Network Working Group                                     T. Bruijnzeels
Internet-Draft                                                NLnet Labs
Obsoletes: 8416 (if approved)                                 T. de Kock
Intended status: Best Current Practice                          RIPE NCC
Expires: 2 December 2023                                     31 May 2023


             RPKI Publication Server Best Current Practices
             draft-timbru-sidrops-publication-server-bcp-00

Abstract

   This document describes best current practices for operating an RFC
   8181 RPKI Publication Server and its rsync and RRDP (RFC 8182) public
   repositories.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 2 December 2023.

Copyright Notice

   Copyright (c) 2023 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.





Bruijnzeels & de Kock    Expires 2 December 2023                [Page 1]

Internet-Draft     RPKI Publication Server Operations           May 2023


Table of Contents

   1.  Requirements notation . . . . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Glossary  . . . . . . . . . . . . . . . . . . . . . . . . . .   2
   4.  Publication Server  . . . . . . . . . . . . . . . . . . . . .   3
     4.1.  Availability  . . . . . . . . . . . . . . . . . . . . . .   3
   5.  RRDP Repository . . . . . . . . . . . . . . . . . . . . . . .   3
     5.1.  Unique Hostname . . . . . . . . . . . . . . . . . . . . .   4
     5.2.  Content Delivery Network  . . . . . . . . . . . . . . . .   4
     5.3.  Limit Size Notification File  . . . . . . . . . . . . . .   4
     5.4.  Sticky Balancing and Notification File Timing . . . . . .   5
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Requirements notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  Introduction

   [RFC8181] describes the RPKI Publication Protocol that is used
   between RPKI Certificate Authorities (CAs) and their Publication
   Repository server.  The server is responsible for handling
   publication requests sent by the CAs, called Publishers in this
   context, and ensuring that their data is made available to RPKI
   Relying Parties (RPs) in in public rsync and RRDP [RFC8182]
   publication points.

   In this document we will describe best current practices based on the
   operational experience of several implementers and operators.

3.  Glossary

     +====================+=========================================+
     | Term               | Description                             |
     +====================+=========================================+
     | Publication Server | [RFC8181] Publication Repository server |
     +--------------------+-----------------------------------------+
     | Publishers         | [RFC8181] Publishers (Certificate       |
     |                    | Authorities)                            |
     +--------------------+-----------------------------------------+
     | RRDP Repository    | Public facing [RFC8182] RRDP repository |



Bruijnzeels & de Kock    Expires 2 December 2023                [Page 2]

Internet-Draft     RPKI Publication Server Operations           May 2023


     +--------------------+-----------------------------------------+
     | Rsync Repository   | Public facing rsync server              |
     +--------------------+-----------------------------------------+

                                 Table 1

4.  Publication Server

   The Publication Server is responsible for handling the server side of
   the [RFC8181] Publication Protocol.  It is responsible for generating
   the content for the public facing RRDP and Rsync Repositories.  It is
   strongly RECOMMENDED that these functions are separated from serving
   the repository content.

4.1.  Availability

   While the repository content MUST be made highly available to any RP
   in the world, the Publication Server only needs to be accessible by
   its publishers.  Dependent on the specific setup this may allow for
   additional access restrictions in this context.  For example, access
   could be limited to known source IP addresses and rate limits may be
   imposed.

   If the Publication Server is not available for some reason, then this
   will impact Publishers in that they will not be able to publish any
   updated RPKI objects in that time.  The most immediate impact of this
   is that the publisher will not be able to update its ROAs, ASPAs or
   BGPSec Router Certificates during this outage.  Thus, it will not be
   able to authorise changes in its routing operations at this time.  If
   the outage persists for a longer period, then the RPKI manifests and
   CRLs published will expire, resulting in the rejecting of CA
   publication points by RPs.

   For this reason the Publication Server MUST be operated in a highly
   available fashion.  Maintenance windows SHOULD be planned and
   communicated to publishers, so that they can avoid - if possible -
   that changes in published RPKI objects will be needed during these
   windows.

5.  RRDP Repository

   In this section we will elaborate on the following recommendations:

   *  Use unique hostname (do not share fate with rsync)

   *  Use CDN if possible

   *  Use randomized paths for Snapshot and Delta Files



Bruijnzeels & de Kock    Expires 2 December 2023                [Page 3]

Internet-Draft     RPKI Publication Server Operations           May 2023


   *  Limit size of Notification File

   *  Combine deltas to limit size of Notification File

   *  Timing of publication of Notification File

5.1.  Unique Hostname

   It is RECOMMENDED that the public RRDP Repository URIs use a hostname
   that is different from both the [RFC8181] service_uri used by
   publishers, and the hostname used in rsync URIs (sia_base).

   Using a unique hostname will allow the operator to use dedicated
   infrastructure and/or a Content Delivery Network for its RRDP content
   without interfering with the other functions.

5.2.  Content Delivery Network

   If possible, it is strongly RECOMMENDED that a Content Delivery
   Network is used to serve the RRDP content.  Care MUST BE taken to
   ensure that the Notification File is not cached for longer than 5
   minutes, unless the back-end RRDP Repository is unavailable, in which
   case it is RECOMMENDED that stale files are served.

   If a CDN is used, then it is likely that it will cache 404s for files
   that are not found on the back-end server.  Because of this the
   Publication Server SHOULD use randomized, unpredictable, paths for
   Snapshot and Delta Files to avoid that the CDN can be tricked into
   caching such 404s for future updates.

   Alternatively, the Publication Server can clear the CDN cache for any
   new files that it publishes.

5.3.  Limit Size Notification File

   The size of the RRDP Notification File can have a big impact on RRDP
   operations.  If this file becomes too large, then it can easily
   result in network congestion if the RRDP Repository does not use any
   CDN, or in high costs if it does.

   [RFC8182] stipulated that any deltas that, when combined with all
   more recent delta, will result in the total size of deltas exceeding
   the size of the snapshot MUST be excluded to avoid that Relying
   Parties download more data than necessary.

   In addition to the restriction described above we RECOMMEND that the
   Notification File size is limited by removing access delta files that
   have been available for more than 30 minutes.  As RP typically



Bruijnzeels & de Kock    Expires 2 December 2023                [Page 4]

Internet-Draft     RPKI Publication Server Operations           May 2023


   refresh their caches every 10 minutes, this will ensure that deltas
   are available for vast majority of RPs, while limiting the size of
   the Notification File.

   Furthermore, we RECOMMEND that Publication Servers with many, e.g.
   1000s of, Publishers ensure that they do not produce Delta Files more
   frequently than once per minute.  A possible approach for this is
   that any publication request sent by a Publisher to the Server SHOULD
   be published immediately if the last delta was produced more than one
   minute ago.  Otherwise the request can be handled by server
   immediately, but the content change is staged for up to 1 minute and
   combined with changes from other Publishers in a single RRDP Delta
   File.

5.4.  Sticky Balancing and Notification File Timing

   Notification Files SHOULD NOT be available to RPs before the
   referenced snapshot and delta files are available.

   This means that in case a load balancing setup is used, then care
   SHOULD be taken to either ensure that RPs that fetch a Notification
   File from one node, will also be served from the same node where the
   referenced snapshot and delta files are available.  Alternatively,
   snapshot and delta files can be pushed out to all nodes first, and
   notification files are pushed out second.

6.  Acknowledgements

   This document is the result of many informal discussions between
   implementers.  Proper acknowledgements will follow.

7.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8181]  Weiler, S., Sonalker, A., and R. Austein, "A Publication
              Protocol for the Resource Public Key Infrastructure
              (RPKI)", RFC 8181, DOI 10.17487/RFC8181, July 2017,
              <https://www.rfc-editor.org/info/rfc8181>.





Bruijnzeels & de Kock    Expires 2 December 2023                [Page 5]

Internet-Draft     RPKI Publication Server Operations           May 2023


   [RFC8182]  Bruijnzeels, T., Muravskiy, O., Weber, B., and R. Austein,
              "The RPKI Repository Delta Protocol (RRDP)", RFC 8182,
              DOI 10.17487/RFC8182, July 2017,
              <https://www.rfc-editor.org/info/rfc8182>.

Authors' Addresses

   Tim Bruijnzeels
   NLnet Labs
   Email: tim@nlnetlabs.nl
   URI:   https://www.nlnetlabs.nl/


   Ties de Kock
   RIPE NCC
   Email: tdekock@ripe.net



































Bruijnzeels & de Kock    Expires 2 December 2023                [Page 6]
